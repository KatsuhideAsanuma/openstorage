

# **API 設計文書**

## **APIリスト**

### **1. 認証と認可**

- **ログイン**:
  - **成功時のHTTPステータス**: `200 OK`
  - **失敗時のHTTPステータス**: `401 Unauthorized` 
  - **エンドポイント**: `/auth/login`
  - **メソッド**: `POST`
  - **リクエスト**: { `username`, `password` }
  - **レスポンス**: { `token` }
  
- **ログアウト**: 
  - **エンドポイント**: `/auth/logout`
  - **メソッド**: `POST`

### **2. 会員登録**

- **エンドポイント**: `/users/register`
- **メソッド**: `POST`
- **リクエスト**: { `username`, `password`, `email`, `user_type` }
- **レスポンス**: { `user_id`, `message` }

- **エラーハンドリング**:
  - 既に存在するメールアドレス: `{ 'error': 'Email already registered.' }`
  - 不正なユーザータイプ: `{ 'error': 'Invalid user type.' }`

### **3. ユーザー情報のCRUD**

- **取得**: 
  - **エンドポイント**: `/users/{user_id}`
  - **メソッド**: `GET`
  
- **更新**:
  - **エンドポイント**: `/users/{user_id}`
  - **メソッド**: `PUT`
  - **リクエスト**: { `username`, `email`, ... }
  
- **削除**:
  - **エンドポイント**: `/users/{user_id}`
  - **メソッド**: `DELETE`

- **エラーハンドリング**:
  - 存在しないユーザーID: `{ 'error': 'User not found.' }`

### **4. メディアのCRUD**

#### **画像**

- **作成**:
  - **エンドポイント**: `/api/v1/images`
  - **メソッド**: `POST`
  
- **読み取り**:
  - **エンドポイント**: `/api/v1/images/:id`
  - **メソッド**: `GET`

- **更新**:
  - **エンドポイント**: `/api/v1/images/:id`
  - **メソッド**: `PUT`

- **削除**:
  - **エンドポイント**: `/api/v1/images/:id`
  - **メソッド**: `DELETE`

#### **テキスト**

- **作成**:
  - **エンドポイント**: `/api/v1/texts`
  - **メソッド**: `POST`
  
- **読み取り**:
  - **エンドポイント**: `/api/v1/texts/:id`
  - **メソッド**: `GET`

- **更新**:
  - **エンドポイント**: `/api/v1/texts/:id`
  - **メソッド**: `PUT`

- **削除**:
  - **エンドポイント**: `/api/v1/texts/:id`
  - **メソッド**: `DELETE`

#### **映像**

- **作成**:
  - **エンドポイント**: `/api/v1/videos`
  - **メソッド**: `POST`
  
- **読み取り**:
  - **エンドポイント**: `/api/v1/videos/:id`
  - **メソッド**: `GET`

- **更新**:
  - **エンドポイント**: `/api/v1/videos/:id`
  - **メソッド**: `PUT`

- **削除**:
  - **エンドポイント**: `/api/v1/videos/:id`
  - **メソッド**: `DELETE`

#### **音楽**

- **作成**:
  - **エンドポイント**: `/api/v1/music`
  - **メソッド**: `POST`
  
- **読み取り**:
  - **エンドポイント**: `/api/v1/music/:id`
  - **メソッド**: `GET`

- **更新**:
  - **エンドポイント**: `/api/v1/music/:id`
  - **メソッド**: `PUT`

- **削除**:
  - **エンドポイント**: `/api/v1/music/:id`
  - **メソッド**: `DELETE`

### **4. APIキーの管理**

- **発行**: 
  - **エンドポイント**: `/api-key/generate`
  - **メソッド**: `POST`
  - **レスポンス**: { `api_key` }
  
- **無効化**:
  - **エンドポイント**: `/api-key/invalidate`
  - **メソッド**: `DELETE`
  - **リクエスト**: { `api_key` }

### **5. フィルタリング**

- **基本クエリ設計**:
  - キーワードによる検索
  
- **拡張**:
  - 深い階層のデータに対してもクエリ可能
  - 使用技術：GraphQL

### **6. ストリーミング**

- **音楽ストリーミング**:
  - **エンドポイント**: `/streaming/music/{id}`
  - **メソッド**: `GET`
  
- **ビデオストリーミング**:
  - **エンドポイント**: `/streaming/video/{id}`
  - **メソッド**: `GET`

### **7. タグとメタデータの管理**

- **登録**:
  - **エンドポイント**: `/metadata`
  - **メソッド**: `POST`
  - **リクエスト**: { `tag`, `metadata_value` }

- **取得**:
  - **エンドポイント**: `/metadata/{tag}`
  - **メソッド**: `GET`

- **更新**:
  - **エンドポイント**: `/metadata/{tag}`
  - **メソッド**: `PUT`
  - **リクエスト**: { `metadata_value` }
  
- **削除**:
  - **エンドポイント**: `/metadata/{tag}`
  - **メソッド**: `DELETE`

### **8. リクエスト・レスポンスのフォーマット**

- **推奨**: JSON

### **9. ページネーション、ソート、フィルタリング**

- クエリパラメーターによる指定



